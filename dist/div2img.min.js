/*! div2img 22-08-2016 XinleiStone 
 github: git+https://github.com/XinleiStone/div2img.git */
var div2img=function(a){function b(a){function b(a){if("svg"!=a.tagName)if(0!==a.children.length&&a.getElementsByTagName("svg").length)for(var c=0;c<a.children.length;c++)b(a.children[c]);else{var d=e(a);html2canvas(a,{onrendered:function(a){m.drawImage(a,d.left-g,d.top-k)}})}else if("svg"==a.tagName){var d=e(a);SVG2Bitmap(a,function(a,b){m.drawImage(a,d.left-g,d.top-k)})}return a}var c=document.getElementById(h),f=d(c),g=f.left,k=f.top,l=document.createElement("canvas");l.setAttribute("id","finalCanvas1"),l.width=f.width,l.height=f.height;var m=l.getContext("2d");m.fillStyle=c.style.backgroundColor||c.style.background||i,m.fillRect(0,0,f.width,f.height);var n=b(c),o=window.setInterval(function(){n==c&&(clearInterval(o),window.setTimeout(function(){var a=document.createElement("a");a.setAttribute("href",l.toDataURL()),a.setAttribute("download",j+".png"),document.body.appendChild(a),a.click(),document.body.removeChild(a)},0))},10)}function c(a){if(!a)throw new Error("Option is not found, please check out the option.");if(h=a.id||h,!document.getElementById(h))throw new Error("Id is wrong, please check the option.");j=a.name||j,i=a.backgroundColor||i}function d(a){for(var b=a.offsetTop,c=a.offsetLeft,d=a.offsetWidth,e=a.offsetHeight;a=a.offsetParent;)b+=a.offsetTop,c+=a.offsetLeft;return{top:b,left:c,width:d,height:e,bottom:b+e,right:c+d}}function e(a){var b,c,d=a,e={top:0,left:0},g=d&&d.ownerDocument;if(g){b=g.documentElement;var h="undefined";return typeof d.getBoundingClientRect!==h&&(e=d.getBoundingClientRect()),c=f(g),{top:e.top+c.pageYOffset-b.clientTop,left:e.left+c.pageXOffset-b.clientLeft}}}function f(a){return g(a)?a:9===a.nodeType&&a.defaultView}function g(a){return null!=a&&a===a.window}var h="",i="#fff",j="img";c(a),b(a);return{downImg:b}};